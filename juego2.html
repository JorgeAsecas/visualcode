<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desarrollo Web En Entorno Cliente</title>
</head>
<body>
    <br>
    <br>
    <button onclick="generar(0);">
        Nuevo Tablero
    </button>

    <table class="tabla2" border="1">
        <tbody>

                <tr width="75px" align="center">
                    <td width="75px" id="td1p1">
                        <div id="l1p1">
                        <button onclick="linea1p1();">
                            xxx
                        </button>
                        </div>
                        <p id="linea1p1">X</p>
                    </td>
                    <td width="75px" id="td1p2">
                        <div id="l1p2">
                        <button onclick="linea1p2();">
                            xxx
                        </button>
                    </div>
                        <p id="linea1p2">X</p>
                    </td>
                    <td width="75px" id="td1p3">
                        <div id="l1p3">
                        <button onclick="linea1p3();">
                            xxx
                        </button>
                    </div>
                        <p id="linea1p3">X</p>
                    </td>
                    <td width="75px" id="td1p4">
                        <div id="l1p4">
                        <button onclick="linea1p4();">
                            xxx
                        </button>
                    </div>
                        <p id="linea1p4">X</p>
                    </td>
                    <td width="75px" id="td1p5">
                        <div id="l1p5">
                        <button onclick="linea1p5();">
                            xxx
                        </button>
                    </div>
                        <p id="linea1p5">X</p>
                    </td>
                    <td width="75px">
                        <p id="fila0">P</p>
                    </td>
                </tr>
                <tr align="center">
                    <td id="td2p1">
                        <div id="l2p1" >
                        <button onclick="linea2p1();">
                            xxx
                        </button>
                    </div>
                        <p id="linea2p1">X</p>
                    </td>
                    <td id="td2p2">
                        <div id="l2p2" >
                        <button onclick="linea2p2();">
                            xxx
                        </button>
                    </div>
                        <p id="linea2p2">X</p>
                    </td>
                    <td id="td2p3">
                        <div id="l2p3">
                        <button onclick="linea2p3();">
                            xxx
                        </button>
                    </div>
                        <p id="linea2p3">X</p>
                    </td>
                    <td id="td2p4">
                        <div id="l2p4">
                        <button onclick="linea2p4();">
                            xxx
                        </button>
                    </div>
                        <p id="linea2p4">X</p>
                    </td>
                    <td id="td2p5">
                        <div id="l2p5">
                        <button onclick="linea2p5();">
                            xxx
                        </button>
                    </div>
                        <p id="linea2p5">X</p>
                    </td>
                    <td>
                        <p id="fila1">P</p>
                    </td>
                </tr>
                <tr align="center">
                    <td id="td3p1">
                        <div id="l3p1">
                        <button onclick="linea3p1();">
                            xxx
                        </button>
                    </div>
                        <p id="linea3p1">X</p>
                    </td>
                    <td id="td3p2">
                        <div id="l3p2">
                        <button onclick="linea3p2();">
                            xxx
                        </button>
                    </div>
                        <p id="linea3p2">X</p>
                    </td>
                    <td id="td3p3">
                        <div id="l3p3">
                        <button onclick="linea3p3();">
                            xxx
                        </button>
                    </div>
                        <p id="linea3p3">X</p>
                    </td>
                    <td id="td3p4">
                        <div id="l3p4">
                        <button onclick="linea3p4();">
                            xxx
                        </button>
                    </div>
                        <p id="linea3p4">X</p>
                    </td>
                    <td id="td3p5">
                        <div id="l3p5">
                        <button onclick="linea3p5();">
                            xxx
                        </button>
                    </div>
                        <p id="linea3p5">X</p>
                    </td>
                    <td>
                        <p id="fila2">P</p>
                    </td>
                </tr>
                <tr align="center">
                    <td id="td4p1">
                        <div id="l4p1">
                        <button onclick="linea4p1();">
                            xxx
                        </button>
                    </div>
                    </div>
                        <p id="linea4p1">X</p>
                    </td>
                    <td id="td4p2">
                        <div id="l4p2">
                        <button onclick="linea4p2();">
                            xxx
                        </button>
                    </div>
                        <p id="linea4p2">X</p>
                    </td>
                    <td id="td4p3">
                        <div id="l4p3">
                        <button onclick="linea4p3();">
                            xxx
                        </button>
                    </div>
                        <p id="linea4p3">X</p>
                    </td>
                    <td id="td4p4">
                        <div id="l4p4">
                            <button onclick="linea4p4();">
                                xxx
                            </button>
                        </div>
                        <p id="linea4p4">X</p>
                    </td>
                    <td id="td4p5">
                        <div id="l4p5">
                        <button onclick="linea4p5();">
                            xxx
                        </button>
                    </div>
                        <p id="linea4p5">X</p>
                    </td>
                    <td>
                        <p id="fila3">P</p>
                    </td>
                </tr>
                <tr align="center">
                    <td id="td5p1">
                        <div id="l5p1">
                        <button onclick="linea5p1();">
                            xxx
                        </button>
                    </div>
                        <p id="linea5p1">X</p>
                    </td>
                    <td id="td5p2">
                        <div id="l5p2">
                        <button onclick="linea5p2();">
                            xxx
                        </button>
                    </div>
                        <p id="linea5p2">X</p>
                    </td>
                    <td id="td5p3">
                        <div id="l5p3">
                        <button onclick="linea5p3();">
                            xxx
                        </button>
                    </div>
                        <p id="linea5p3">X</p>
                    </td>
                    <td id="td5p4">
                        <div id="l5p4">
                        <button onclick="linea5p4();">
                            xxx
                        </button>
                    </div>
                        <p id="linea5p4">X</p>
                    </td>
                    <td id="td5p5">
                        <div id="l5p5">
                        <button onclick="linea5p5();">
                            xxx
                        </button>
                    </div>
                        <p id="linea5p5">X</p>
                    </td>
                    <td>
                        <p id="fila4">P</p>
                    </td>
                </tr>
                <tr align="center">
                    <td>
                        <p id="columna0">P</p>
                    </td>
                    <td>
                        <p id="columna1">P</p>
                    </td>
                    <td>
                        <p id="columna2">P</p>
                    </td>
                    <td>
                        <p id="columna3">P</p>
                    </td>
                    <td>
                        <p id="columna4">P</p>
                    </td>
                    <td>
                        <p id="totalp" >P</p>
                    </td>
                </tr>
        </tbody>
    </table>
    <script>
        puntuacion = 0






        function color(filat, columnat,filaa, columnaa) {
            if (tablero[filaa][columnaa] == 3) {
                document.getElementById("td" + filat + "p" + columnat).style.backgroundColor = "#00FF00";
                document.getElementById("td" + filat + "p" + columnat).style.color = "#000000";
            } else if (tablero[filaa][columnaa] == 2){
                document.getElementById("td" + filat + "p" + columnat).style.backgroundColor = "#81FF81";
                document.getElementById("td" + filat + "p" + columnat).style.color = "#000000";
            } else if (tablero[filaa][columnaa] == 1){
                document.getElementById("td" + filat + "p" + columnat).style.backgroundColor = "#C8FFC8";
                document.getElementById("td" + filat + "p" + columnat).style.color = "#000000";
            }

        }
        function perdiste() {
            window.location.reload()
            alert('Perdiste, crea un nuevo tablero por favor')
        }
        function condicional(fila, columna) {
            return tablero[fila][columna] == null ? perdiste() : tablero[fila][columna]

        }
        function imprimir(filatabla, columnatabla, filaarray, columnaarray) {

            puntuacion += tablero[filaarray][columnaarray] == null ? 0: tablero[filaarray][columnaarray]
            document.getElementById("linea" + filatabla + "p" + columnatabla).innerHTML = condicional(filaarray, columnaarray)
            document.getElementById("totalp").innerHTML = "TOTAL P:" + "<br>" + puntuacion
            document.getElementById("l" + filatabla + "p" + columnatabla).innerHTML = ""
            color(filatabla, columnatabla, filaarray, columnaarray)
            if (total == puntuacion) {
                alert('Ganaste, sigue jugando')
                generar(puntuacion)
                total += puntuacion
            }
            console.log(total)
            console.log(puntuacion)

        }
        function linea1p1() {

            imprimir(1, 1, 0, 0)
        }
        function linea1p2() {

            imprimir(1, 2, 0, 1)

        }
        function linea1p3() {

            imprimir(1, 3, 0, 2)

        }
        function linea1p4() {
            imprimir(1, 4, 0, 3)

        }
        function linea1p5() {
            imprimir(1, 5, 0, 4)

        }
        function linea2p1() {
            imprimir(2, 1, 1, 0)

        }
        function linea2p2() {
            imprimir(2, 2, 1, 1)
        }
        function linea2p3() {
            imprimir(2, 3, 1, 2)

        }
        function linea2p4() {
            imprimir(2, 4, 1, 3)

        }
        function linea2p5() {
            imprimir(2, 5, 1, 4)

        }
        function linea3p1() {
            imprimir(3, 1, 2, 0)

        }
        function linea3p2() {
            imprimir(3, 2, 2, 1)

        }
        function linea3p3() {
            imprimir(3, 3, 2, 2)

        }
        function linea3p4() {
            imprimir(3, 4, 2, 3)

        }
        function linea3p5() {
            imprimir(3, 5, 2, 4)
        }
        function linea4p1() {
            imprimir(4, 1, 3, 0)

        }
        function linea4p2() {
            imprimir(4, 2, 3, 1)

        }
        function linea4p3() {
            imprimir(4, 3, 3, 2)

        }
        function linea4p4() {
            imprimir(4, 4, 3, 3)

        }
        function linea4p5() {
            imprimir(4, 5, 3, 4)

        }
        function linea5p1() {
            imprimir(5, 1, 4, 0)

        }
        function linea5p2() {
            imprimir(5, 2, 4, 1)

        }
        function linea5p3() {
            imprimir(5, 3, 4, 2)

        }
        function linea5p4() {
            imprimir(5, 4, 4, 3)

        }
        function linea5p5() {
            imprimir(5, 5, 4, 4)

        }

        function generar(puntoos) {
            total = 0
            puntuacion = puntoos
            sumapc = 0
            bombasc = 0
            sumapf = 0
            bombasf = 0
            tablero = new Array(5)


            //Creo el arraymultidimensional
            //

        for (i = 0; i < tablero.length; i++) {
            tablero[i] = new Array(5)


        }



            //Generar array multidimensional con numeros aleatorios
            //en posiciones aleatorias y con huecos aleatorios

            for (i = 0; i < 21; i++) {
                fila = Math.floor(Math.random() * 5)
                columna = Math.floor(Math.random() * 5)

                tablero[fila][columna] = Math.floor((Math.random() * 3) + 1)


            }
            console.log(tablero)

            //Contar puntos y bombas columnas
            //
            for (i = 0; i < 5; i++) {
                for (i2 = 0; i2 < 5; i2++) {
                    sumapc += tablero[i2][i] == null ? 0 : tablero[i2][i]
                    bombasc += tablero[i2][i] == null ? 1 : 0
                    document.getElementById("columna" + i).innerHTML ="P: " +  sumapc + "<br>" + "B: " + bombasc


                }
                sumapc = 0
                bombasc = 0
            }
            //Contar puntos y bombas fila
            //
            for (i = 0; i < 5; i++) {
                for (i2 = 0; i2 < 5; i2++) {
                    sumapf += tablero[i][i2] == null ? 0 : tablero[i][i2]
                    bombasf += tablero[i][i2] == null ? 1 : 0
                    document.getElementById("fila" + i).innerHTML ="P: " +  sumapf + "<br>" + "B: " + bombasf


                }
                sumapf = 0
                bombasf = 0

            }

            //Puntos a cero o los mismos si ganas
            //

            document.getElementById("totalp").innerHTML = "P: " + puntoos

            // Volver a escribir las "X"
            //
            for (i = 1; i < 6; i++) {
                for (i2 = 1; i2 < 6; i2++) {

                    document.getElementById("linea" + i + "p" + i2).innerHTML = "X"
        }
    }

            //Al  pulsar el boton este se elimina
            //Aqui se vuelven a generar los botones con cada nuevo tablero
            //
            for (i = 1; i < 6; i++) {
                        for (i2 = 1; i2 < 6; i2++) {

            document.getElementById("l" + i + "p" + i2).innerHTML = '<button onclick=' + '"linea' + i + 'p' + i2 + '();"' + '>xxx</button>'
                        }
        }

            //Resetear el color
            //
            for (i = 1; i < 6; i++) {
                        for (i2 = 1; i2 < 6; i2++) {
                            document.getElementById("td" + i + "p" + i2).style.backgroundColor = "white";
                            document.getElementById("td" + i + "p" + i2).style.color = "#000000";

                        }
        }
        //Cuento maximo de puntos para ganar
        //
        for (i = 0; i < 5; i++) {
                for (i2 = 0; i2 < 5; i2++) {
                    total += tablero[i][i2] == null ? 0: tablero[i][i2]

        }
    }
        }




    </script>
</body>
</html>
